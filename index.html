<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Custom Push Origin Demo</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <header>
            <h1>OneSignal <br/> Custom Push Origin Demo</h1>
        </header>
        <section>
            <h3>
                <a id="how-does-this-demo-work" class="anchor" href="#how-does-this-demo-work" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How does this demo work?</h3>

            <p><strong>Note:</strong> <a href="https://onesignal.github.io/CustomPushOriginSubdomainDemo">See the "<em>your-custom-subdomain.yoursite.com</em>" part of this demo here.</a></p>
            <p>This site represents the "<em>yoursite.com</em>" user-facing site, which:</p>
            <ul>
                <li>Creates a hidden iFrame to <code>http(s):your-custom-subdomain.yoursite.com/popup.html</code> to communicate with the OneSignal integration (checking for subscribed state, sending tags..etc.)</li>
                <li>Opens a popup window to <code>http(s):your-custom-subdomain.yoursite.com/subscribe.html</code> to actually subscribe users to push.</li>
            </ul>

            <p>Users are actually subscribing to push notifications in a new window pointing to <code>http(s)://your-custom-subdomain.yoursite.com/subscribe.html</code>.</p>


            <h3>
                <a id="how-can-i-reset-my-state-to-test-like-a-new-user" class="anchor" href="#how-can-i-reset-my-state-to-test-like-a-new-user" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How can I reset my state to test like a new user?</h3>
            <p>Please <a href="https://documentation.onesignal.com/docs/troubleshooting-web-push#section-clearing-your-cache-and-resetting-push-permissions" target="doc">follow these instructions</a> to wipe your site's storage and reset your notification permissions.</p>
            <p><em>Be sure to close</em> all existing tabs to this site after following those instructions, or simply restart your browser, to complete the reset process.</p>

            <h3>Where can I see the code?</h3>
            <ul>
                <li><strong>iframe-init.js</strong> - Initializes the iframe to check subscription status and communicate with your remote OneSignal integration <a href="https://github.com/OneSignal/CustomPushOriginDemo/blob/gh-pages/javascripts/iframe-init.js" target="code">(view)</a></li>
            </ul>
            <p>
                Be sure to open the <strong>Chrome Developer Tools</strong> console and look at the logs too!
            </p>
            <hr>

            <div class="hidden show-when-subscribed">
                <h3>How can I access my dashboard and see my users?</h3>

                <p>You're subscribed! <em>The following user ID was remotely pulled from the iFrame:</em></p>

                <p>
                    <strong>Your User Id: <code><span id="my-user-id"></span></code></strong>
                </p>

                <p>If you don't have a pre-assigned login, you can log in to this app's <a href="https://onesignal.com" target="login">OneSignal dashboard</a> with:</p>
                <ul>
                    <li>
                        <strong>Username:</strong> <code>jason+webpushdemo@onesignal.com</code>
                    </li>
                    <li>
                        <strong>Password:</strong> <code>123123123</code>
                    </li>
                </ul>
            </div>

            <div class="hidden show-when-unsubscribed">
                <h3>Subscribe to Notifications</h3>

                <p>If you're not automatically prompted, click below to Subscribe.</p>

                <p><button id="button-subscribe">Subscribe to notifications</button></p>
                
                <script src="https://gist.github.com/jasonpang/42a4386924c1d1d179000992cc56eb4c.js"></script>
            </div>
        </section>
        <footer>
        </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    <script src="javascripts/iframe-init.js"></script>
</body>

</html>
